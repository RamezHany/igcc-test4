<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار نظام المصادقة</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            background-color: #f0f2f5;
            margin: 0;
            padding: 20px;
            direction: rtl;
        }
        .container {
            max-width: 600px;
            margin: 20px auto;
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.15);
        }
        h2 {
            color: #333;
            margin-bottom: 20px;
        }
        .test-section {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: right;
        }
        .test-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .failure {
            background-color: #f8d7da;
            color: #721c24;
        }
        button {
            background-color: #4267B2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #365899;
        }
        .actions {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>اختبار نظام المصادقة</h2>
        
        <div class="test-section">
            <div class="test-title">حالة تسجيل الدخول الحالية:</div>
            <div id="loginStatus" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">وقت الجلسة:</div>
            <div id="sessionTime" class="test-result"></div>
        </div>
        
        <div class="test-section">
            <div class="test-title">الوقت المتبقي للجلسة:</div>
            <div id="remainingTime" class="test-result"></div>
        </div>
        
        <div class="actions">
            <button id="simulateLogin">محاكاة تسجيل الدخول</button>
            <button id="simulateLogout">محاكاة تسجيل الخروج</button>
            <button id="refreshStatus">تحديث الحالة</button>
            <button id="goToLogin">الذهاب إلى صفحة تسجيل الدخول</button>
            <button id="goToAdmin">الذهاب إلى لوحة التحكم</button>
        </div>
    </div>
    
    <script>
        // وقت انتهاء الجلسة (30 دقيقة = 1800000 مللي ثانية)
        const SESSION_DURATION = 1800000;
        
        // تحديث حالة تسجيل الدخول
        function updateStatus() {
            const authenticated = localStorage.getItem('adminAuthenticated');
            const loginTime = localStorage.getItem('adminLoginTime');
            const currentTime = new Date().getTime();
            
            // عرض حالة تسجيل الدخول
            const loginStatus = document.getElementById('loginStatus');
            if (authenticated === 'true') {
                loginStatus.textContent = 'مسجل الدخول';
                loginStatus.className = 'test-result success';
            } else {
                loginStatus.textContent = 'غير مسجل الدخول';
                loginStatus.className = 'test-result failure';
            }
            
            // عرض وقت تسجيل الدخول
            const sessionTime = document.getElementById('sessionTime');
            if (loginTime) {
                const loginDate = new Date(parseInt(loginTime));
                sessionTime.textContent = `تم تسجيل الدخول في: ${loginDate.toLocaleString()}`;
                sessionTime.className = 'test-result success';
            } else {
                sessionTime.textContent = 'لا يوجد وقت تسجيل دخول مسجل';
                sessionTime.className = 'test-result failure';
            }
            
            // عرض الوقت المتبقي للجلسة
            const remainingTime = document.getElementById('remainingTime');
            if (loginTime) {
                const elapsedTime = currentTime - parseInt(loginTime);
                const remaining = SESSION_DURATION - elapsedTime;
                
                if (remaining > 0) {
                    const minutes = Math.floor(remaining / 60000);
                    const seconds = Math.floor((remaining % 60000) / 1000);
                    remainingTime.textContent = `الوقت المتبقي: ${minutes} دقيقة و ${seconds} ثانية`;
                    remainingTime.className = 'test-result success';
                } else {
                    remainingTime.textContent = 'انتهت صلاحية الجلسة';
                    remainingTime.className = 'test-result failure';
                }
            } else {
                remainingTime.textContent = 'لا توجد جلسة نشطة';
                remainingTime.className = 'test-result failure';
            }
        }
        
        // محاكاة تسجيل الدخول
        document.getElementById('simulateLogin').addEventListener('click', function() {
            const currentTime = new Date().getTime();
            localStorage.setItem('adminLoginTime', currentTime);
            localStorage.setItem('adminAuthenticated', 'true');
            updateStatus();
        });
        
        // محاكاة تسجيل الخروج
        document.getElementById('simulateLogout').addEventListener('click', function() {
            localStorage.removeItem('adminAuthenticated');
            localStorage.removeItem('adminLoginTime');
            updateStatus();
        });
        
        // تحديث الحالة
        document.getElementById('refreshStatus').addEventListener('click', updateStatus);
        
        // الذهاب إلى صفحة تسجيل الدخول
        document.getElementById('goToLogin').addEventListener('click', function() {
            window.location.href = 'login.html';
        });
        
        // الذهاب إلى لوحة التحكم
        document.getElementById('goToAdmin').addEventListener('click', function() {
            window.location.href = 'admin-panel.html';
        });
        
        // تحديث الحالة عند تحميل الصفحة
        window.addEventListener('load', updateStatus);
        
        // تحديث الحالة كل ثانية
        setInterval(updateStatus, 1000);
    </script>
</body>
</html>
